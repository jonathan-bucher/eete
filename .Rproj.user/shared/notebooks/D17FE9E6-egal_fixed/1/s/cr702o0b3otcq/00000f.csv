"0","egamma = function(x, gam){"
"0","  if (gam != 1){"
"0","    val = x^(1-gam)/(1-gam)"
"0","  }else{"
"0","    val =log(x)"
"0","  }"
"0","  return(val)"
"0","}"
"0",""
"0","inverse = function (f, lower = -100, upper = 100) {"
"0","  function (y) uniroot((function (x) f(x) - y), lower = lower, upper = upper)[1]"
"0","}"
"0",""
"0","eete = function(inputFunction, ..., y, d, z, data, lower = 0.1, upper = 100) {"
"0","  "
"0","  fun_inverse = inverse(function(x) inputFunction(x, ...), lower, upper)"
"0","  "
"0","  data1 = data %>% "
"0","    filter(!!sym(z) == 1)"
"0","  "
"0","  data0 = data %>% "
"0","    filter(!!sym(z) == 0)"
"0","  "
"0","  yz1 = data1[[y]]"
"0","  yz0 = data0[[y]]"
"0","  p1 = mean(data1[[d]], na.rm = TRUE)"
"0","  p0 = mean(data0[[d]], na.rm = TRUE)"
"0","  "
"0","  fee_p1 = mean(inputFunction(yz1, ...), na.rm = TRUE)"
"0","  fee_p0 = mean(inputFunction(yz0, ...), na.rm = TRUE)"
"0","  fee1 = (((1 - p0) * fee_p1 - (1 - p1) * fee_p0) / (p1 - p0))"
"0","  fee0 = ((p1 * fee_p0 - p0 * fee_p1) / (p1 - p0))"
"0","  "
"0","  eete = (fun_inverse(fee1)$root - fun_inverse(fee0)$root)"
"0",""
"0","  return(eete)"
"0","}"
